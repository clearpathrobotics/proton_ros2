nodes:
  - name: pc
    transport:
      type: serial
      device: /tmp/ttyPC
  - name: mcu
    transport:
      type: serial
      device: /tmp/ttyMCU
bundles:
  - name: log
    id: 0x100
    producer: mcu
    consumer: pc
    signals:
      - {name: level, type: uint32}
      - {name: name, type: string, capacity: 64}
      - {name: msg, type: string, capacity: 64}
      - {name: file, type: string, capacity: 64}
      - {name: function, type: string, capacity: 64}
      - {name: line, type: uint32}
  - name: status
    id: 0x101
    producer: mcu
    consumer: pc
    signals:
      - {name: hardware_id, type: string, capacity: 10}
      - {name: firmware_version, type: string, capacity: 10}
      - {name: mcu_uptime_s, type: int32}
      - {name: mcu_uptime_ns, type: uint32}
      - {name: connection_uptime_s, type: int32}
      - {name: connection_uptime_ns, type: uint32}
  - name: power
    id: 0x102
    producer: mcu
    consumer: pc
    signals:
      - {name: measured_voltages, type: float, length: 3}
      - {name: measured_currents, type: float, length: 4}
  - name: emergency_stop
    id: 0x103
    producer: mcu
    consumer: pc
    signals:
      - {name: data, type: bool}
  - name: temperature
    id: 0x104
    producer: mcu
    consumer: pc
    signals:
      - {name: temperatures, type: float, length: 2}
  - name: stop_status
    id: 0x105
    producer: mcu
    consumer: pc
    signals:
      - {name: external_stop_present, type: bool}
  - name: imu
    id: 0x106
    producer: mcu
    consumer: pc
    signals:
      - {name: frame_id, type: string, capacity: 16}
      - {name: linear_acceleration, type: double, length: 3}
      - {name: angular_velocity, type: double, length: 3}
  - name: magnetometer
    id: 0x107
    producer: mcu
    consumer: pc
    signals:
      - {name: frame_id, type: string, capacity: 16}
      - {name: magnetic_field, type: double, length: 3}
  - name: nmea
    id: 0x108
    producer: mcu
    consumer: pc
    signals:
      - {name: frame_id, type: string, capacity: 16}
      - {name: sentence, type: string, capacity: 324}
  - name: motor_feedback
    id: 0x109
    producer: mcu
    consumer: pc
    signals:
      - {name: current, type: float, length: 2}
      - {name: bridge_temperature, type: float, length: 2}
      - {name: motor_temperature, type: float, length: 2}
      - {name: driver_fault, type: bool, length: 2}
      - {name: duty_cycle, type: float, length: 2}
      - {name: measured_velocity, type: float, length: 2}
      - {name: measured_travel, type: float, length: 2}
      - {name: commanded_mode, type: int32}
      - {name: actual_mode, type: int32}

  - name: wifi_connected
    id: 0x200
    producer: pc
    consumer: mcu
    signals:
      - {name: connected, type: bool}
  - name: hmi
    id: 0x201
    producer: pc
    consumer: mcu
    signals:
      - {name: state, type: uint32}
  - name: motor_command
    id: 0x202
    producer: pc
    consumer: mcu
    signals:
      - {name: mode, type: int32}
      - {name: command, type: float, length: 2}

ros2:
  topics:
    - {topic: /rosout,                          message: rcl_interfaces/msg/Log,                    qos.profile: rosout,       bundle: log}
    - {topic: platform/mcu/status,              message: clearpath_platform_msgs/msg/Status,        qos.profile: sensor_data,  bundle: status}
    - {topic: platform/mcu/status/power,        message: clearpath_platform_msgs/msg/Power,         qos.profile: sensor_data,  bundle: power}
    - {topic: platform/mcu/status/temperature,  message: clearpath_platform_msgs/msg/Temperature,   qos.profile: sensor_data,  bundle: temperature}
    - {topic: platform/mcu/status/stop,         message: clearpath_platform_msgs/msg/StopStatus,    qos.profile: sensor_data,  bundle: stop_status}
    - {topic: platform/emergency_stop,          message: std_msgs/msg/Bool,                         qos.profile: sensor_data,  bundle: emergency_stop}
    - {topic: platform/motors/feedback,         message: clearpath_platform_msgs/msg/Feedback,      qos.profile: sensor_data,  bundle: motor_feedback}
    - {topic: sensors/imu_0/data_raw,           message: sensor_msgs/msg/Imu,                       qos.profile: sensor_data,  bundle: imu}
    - {topic: sensors/imu_0/mag,                message: sensor_msgs/msg/MagneticField,             qos.profile: sensor_data,  bundle: magnetometer}
    - {topic: sensors/gps_0/nmea_sentence,      message: nmea_msgs/msg/Sentence,                    qos.profile: sensor_data,  bundle: nmea}
    - {topic: platform/wifi_connected,          message: std_msgs/msg/Bool,                         qos.profile: sensor_data,  bundle: wifi_connected}
    - {topic: platform/mcu/_hmi,                message: std_msgs/msg/UInt8,                        qos.profile: sensor_data,  bundle: hmi}
    - {topic: platform/motors/cmd_drive,        message: clearpath_platform_msgs/msg/Drive,         qos.profile: sensor_data,  bundle: motor_command}
